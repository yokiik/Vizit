# 🎯 Как запустить Swagger на сервере

## Минимальные шаги

```ascii
┌─────────────────────────────────────────────────────────────┐
│  1. Подключитесь к серверу                                   │
│     ssh root@123.45.67.89                                    │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  2. Установите Python (если нужно)                           │
│     sudo apt update                                          │
│     sudo apt install python3 python3-pip python3-venv -y     │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  3. Клонируйте репозиторий                                   │
│     git clone https://github.com/yokiik/Vizit.git            │
│     cd Vizit/python_version                                  │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  4. Установите зависимости                                   │
│     python3 -m venv venv                                     │
│     source venv/bin/activate                                 │
│     pip install -r requirements.txt                          │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  5. Запустите приложение                                     │
│     python3 main.py                                          │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  6. Откройте в браузере                                      │
│     http://123.45.67.89:8088/docs                            │
└─────────────────────────────────────────────────────────────┘
```

---

## 📦 Что делает каждая команда

### Шаг 1: SSH подключение
```bash
ssh root@123.45.67.89
```
**Что происходит:** Подключаетесь к удаленному серверу через SSH.

---

### Шаг 2: Установка Python
```bash
sudo apt update
sudo apt install python3 python3-pip python3-venv -y
```
**Что происходит:** 
- Обновляется список пакетов
- Устанавливается Python 3, pip (менеджер пакетов) и venv (виртуальные окружения)

---

### Шаг 3: Клонирование репозитория
```bash
git clone https://github.com/yokiik/Vizit.git
cd Vizit/python_version
```
**Что происходит:** 
- Скачивается ваш код с GitHub
- Переход в папку с Python версией проекта

---

### Шаг 4: Установка зависимостей
```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```
**Что происходит:** 
- Создается изолированное Python окружение (venv)
- Активируется виртуальное окружение
- Устанавливаются все необходимые библиотеки из requirements.txt:
  - FastAPI (веб-фреймворк)
  - Uvicorn (ASGI сервер)
  - Selenium (автоматизация браузера)
  - и другие...

---

### Шаг 5: Запуск приложения
```bash
python3 main.py
```
**Что происходит:** 
- Запускается FastAPI приложение
- Стартует Uvicorn сервер на порту 8088
- Swagger UI автоматически доступен по адресу `/docs`

Вы увидите:
```
=== RLI Systems Python Version ===
Starting web interface...
[OK] Data storage initialized
[OK] Business services created
[INFO] Starting server on port 8088
[INFO] Open browser: http://localhost:8088
[INFO] Swagger docs: http://localhost:8088/docs
Press Ctrl+C to stop
```

---

### Шаг 6: Открыть Swagger UI
```
http://123.45.67.89:8088/docs
```
**Что происходит:** 
- В браузере открывается интерактивная документация API
- Видите все доступные методы
- Можете тестировать каждый метод прямо в браузере

---

## 🎮 Как пользоваться Swagger UI

```ascii
┌──────────────────────────────────────────────────────────┐
│  Swagger UI - Интерактивная документация API              │
├──────────────────────────────────────────────────────────┤
│                                                           │
│  ▼ GET  /api/tasks          Получает список заданий      │
│     ├─ [Try it out]  ← нажмите сюда                      │
│     ├─ [Execute]     ← затем выполните                   │
│     └─ Response:                                          │
│        Code: 200                                          │
│        Body: [{"id": "...", "type_task": "Ввоз", ...}]   │
│                                                           │
│  ▼ POST /api/tasks/create   Создает новое задание        │
│     ├─ [Try it out]                                       │
│     ├─ Request body:                                      │
│     │   {                                                 │
│     │     "type_task": "Ввоз",                            │
│     │     "status": "Новое",                              │
│     │     "date": "2025-11-01",                           │
│     │     ...                                             │
│     │   }                                                 │
│     ├─ [Execute]                                          │
│     └─ Response: {"message": "Задание создано..."}       │
│                                                           │
└──────────────────────────────────────────────────────────┘
```

### Пошаговая инструкция тестирования

1. **Найдите нужный метод** в списке
2. **Нажмите на него** - раскроется описание
3. **Нажмите "Try it out"** - активируется форма
4. **Заполните параметры** (если требуется)
5. **Нажмите "Execute"** - отправится запрос
6. **Смотрите результат** - ответ сервера появится ниже

---

## 🔥 Быстрые тесты

### Тест 1: Проверить работу API
```bash
# В терминале сервера
curl http://localhost:8088/api/tasks
```
**Ожидаемый результат:** JSON с массивом заданий (может быть пустым)

### Тест 2: Проверить Swagger UI
```bash
# В терминале сервера
curl http://localhost:8088/docs
```
**Ожидаемый результат:** HTML код страницы Swagger UI

### Тест 3: Проверить доступность с вашего компьютера
```bash
# На вашем компьютере
curl http://123.45.67.89:8088/api/tasks
```
**Ожидаемый результат:** JSON с заданиями

Если не работает - проверьте firewall!

---

## 🛡️ Открыть порт в firewall

Если Swagger не открывается в браузере:

```bash
# Проверьте firewall
sudo ufw status

# Откройте порт 8088
sudo ufw allow 8088/tcp

# Перезагрузите правила
sudo ufw reload

# Проверьте снова
sudo ufw status
```

Должно появиться:
```
8088/tcp                   ALLOW       Anywhere
```

---

## 📊 Структура API

После запуска доступны следующие группы методов:

| Группа | Методов | Описание |
|--------|---------|----------|
| 📋 **Tasks** | 5 | Управление заданиями (создать, получить, обновить, удалить, переупорядочить) |
| ⚙️ **Settings** | 2 | Настройки приложения (получить, обновить) |
| 📚 **References** | 3 | Справочники (получить, добавить элемент, удалить элемент) |
| 📄 **Logs** | 1 | Логи системы (получить последние 100 записей) |
| 🤖 **Automation** | 2 | Автоматизация (запустить, остановить) |
| 🔌 **Connection** | 1 | Тест подключения к внешней системе |

**Всего:** 14 методов

---

## 🔄 Автоматический деплой (опционально)

Если хотите, чтобы при каждом `git push` код автоматически обновлялся на сервере:

### 3 простых шага:

#### 1. Создайте SSH ключ на сервере
```bash
ssh-keygen -t rsa -b 4096 -C "github" -f ~/.ssh/github_key
cat ~/.ssh/github_key.pub >> ~/.ssh/authorized_keys
```

#### 2. Добавьте ключ в GitHub
- Откройте: https://github.com/yokiik/Vizit/settings/keys
- Нажмите "Add deploy key"
- Вставьте содержимое `~/.ssh/github_key.pub`
- ✅ Отметьте "Allow write access"

#### 3. Добавьте секреты в GitHub
- Откройте: https://github.com/yokiik/Vizit/settings/secrets/actions
- Добавьте:
  - `VDS_HOST` = IP вашего сервера
  - `VDS_USERNAME` = имя пользователя SSH
  - `VDS_SSH_KEY` = содержимое `~/.ssh/github_key`

**Готово!** Теперь при `git push` код автоматически развернется на сервере.

---

## 🚀 Для постоянной работы

Если хотите, чтобы приложение работало постоянно (даже после перезагрузки сервера):

```bash
# Переместите в постоянную директорию
sudo mkdir -p /var/www/apps
sudo cp -r ~/Vizit /var/www/apps/rli-systems
cd /var/www/apps/rli-systems/python_version

# Настройте systemd
sudo cp systemd/rli-systems.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable rli-systems.service
sudo systemctl start rli-systems.service
sudo systemctl status rli-systems.service
```

Теперь приложение:
- ✅ Запускается автоматически при загрузке сервера
- ✅ Перезапускается при падении
- ✅ Работает в фоне
- ✅ Swagger доступен 24/7

### Управление сервисом:
```bash
# Перезапустить
sudo systemctl restart rli-systems.service

# Остановить
sudo systemctl stop rli-systems.service

# Посмотреть логи
sudo journalctl -u rli-systems.service -f
```

---

## ✅ Чек-лист готовности

- [ ] Сервер доступен по SSH
- [ ] Python 3 установлен
- [ ] Репозиторий склонирован
- [ ] Зависимости установлены
- [ ] Приложение запущено
- [ ] Порт 8088 открыт в firewall
- [ ] Swagger UI открывается в браузере
- [ ] API методы отвечают

---

## 📱 Доступные адреса

После запуска:

| Адрес | Что там |
|-------|---------|
| `http://IP:8088/` | Главная страница с веб-интерфейсом |
| `http://IP:8088/docs` | ⭐ **Swagger UI** - интерактивная документация |
| `http://IP:8088/redoc` | ReDoc - альтернативная документация |
| `http://IP:8088/api/tasks` | Пример API endpoint (JSON) |

---

## 🆘 Что-то не работает?

### Приложение не запускается
```bash
# Проверьте Python версию (должна быть 3.8+)
python3 --version

# Переустановите зависимости
source venv/bin/activate
pip install -r requirements.txt --force-reinstall
```

### Swagger не открывается
```bash
# Проверьте, что приложение работает
ps aux | grep python

# Проверьте порт
sudo netstat -tlnp | grep 8088

# Откройте порт в firewall
sudo ufw allow 8088/tcp
```

### Ошибка при клонировании репозитория
```bash
# Если репозиторий приватный, используйте токен
git clone https://TOKEN@github.com/yokiik/Vizit.git
```

---

## 📚 Дополнительная документация

- **SWAGGER_БЫСТРЫЙ_СТАРТ.md** - самая короткая инструкция (2 мин)
- **БЫСТРЫЙ_ЗАПУСК_НА_СЕРВЕРЕ.md** - подробная инструкция
- **DEPLOYMENT_GUIDE.md** - полное руководство по развертыванию
- **API_ДЛЯ_ФРОНТЕНДА.md** - документация всех API методов

---

## 🎉 Готово!

Теперь вы можете:
1. ✅ Запустить API на сервере
2. ✅ Открыть Swagger UI
3. ✅ Тестировать все методы
4. ✅ Разрабатывать и отлаживать API

**Swagger UI:** `http://ВАШ_IP:8088/docs` 🚀

---

**Создано:** 2025-10-31  
**Автор:** AI Assistant  
**Версия:** 1.0

